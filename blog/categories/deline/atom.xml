<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: deline | Adam Ginsburg's Astro Blog]]></title>
  <link href="http://keflavich.github.com/blog/categories/deline/atom.xml" rel="self"/>
  <link href="http://keflavich.github.com/"/>
  <updated>2012-12-28T17:22:06-07:00</updated>
  <id>http://keflavich.github.com/</id>
  <author>
    <name><![CDATA[Adam Ginsburg]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Delining - Maps]]></title>
    <link href="http://keflavich.github.com/blog/2011/02/03/delining-maps/"/>
    <updated>2011-02-03T15:16:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/02/03/delining-maps</id>
    <content type="html"><![CDATA[<div class='post'>
First comment - delining has <b>no effect</b> on downsampled data.  At least for the 0709 epoch, there were NO lines AT ALL in the data.  From 0-5 Hz, it was just empty.  So we don't have to worry about that... the problem only affects fully-sampled data.<br /><br />Then, onto map comparisons.  Curiously, the noise levels don't drop after delining.  They actually go up a bit.  This may be because of the effects on PCA cleaning.<br /><br />However, flux levels in the sources go up by 0-10%.  As usual, the change in flux changes from field to field without any obvious reason.<br /><br />Example 1: A pointing field.  The source is ~2% brighter in the delined version, but otherwise the match between the two is nearly perfect.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUskr5xAMSI/AAAAAAAAF_M/J65CutNg9hM/s1600/101208_ob8_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUskr5xAMSI/AAAAAAAAF_M/J65CutNg9hM/s320/101208_ob8_compare.png" /></a><br /><br /><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsksatOJSI/AAAAAAAAF_U/9X-rM6JQmCU/s1600/101208_ob8_psd.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsksatOJSI/AAAAAAAAF_U/9X-rM6JQmCU/s320/101208_ob8_psd.png" /></a></div><br />Example 2: A bigger map, where the flux recovery is much greater when delining, but the background levels are also higher.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsoBrKcQyI/AAAAAAAAF_c/junIzma1zg4/s1600/101208_o11_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsoBrKcQyI/AAAAAAAAF_c/junIzma1zg4/s320/101208_o11_compare.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsoCFL1DiI/AAAAAAAAF_k/b1QrgajdlaE/s1600/101208_o11_psd.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsoCFL1DiI/AAAAAAAAF_k/b1QrgajdlaE/s320/101208_o11_psd.png" /></a></div></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Delining and the Cleaning process]]></title>
    <link href="http://keflavich.github.com/blog/2011/02/03/delining-and-cleaning-process/"/>
    <updated>2011-02-03T12:49:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/02/03/delining-and-cleaning-process</id>
    <content type="html"><![CDATA[<div class='post'>
One item I forgot to mention last night was the effects of lines/delining on<br />PCA subtraction.  These should be the primary effects on the final map for all<br />epochs except 2010, in which case the primary effect SHOULD be to reduce<br />substantial noise.<br /><br><br />In the examples below, there are PSDs of whole timestreams (left) and<br />example timestreams from single scans (right).  The first thing to note is that<br />the delined timestreams still have correlated components in the line region,<br />but they are suppressed - their amplitudes, and therefore their sort order in<br />the PCA removal scheme, are changed.  Since PCA cleaning is by its nature adaptive<br />(the number of components remains fixed, but the order changes), these effects<br />can be significant and dangerous.  If the line noise is more correlated, a PCA<br />component will be dedicated to removing it instead of atmospheric signal.<br /><br><br />Below are examples from l089 (epoch 0709) first.  These have less correlated<br />line noise and are more typical of BGPS observations. The first PCA component,<br />the average, does not change much with PCA cleaning.  However it is clear that<br />the second component changes substantially, from large-amplitude high-frequency<br />noise to small-amplitude variations that are very likely to describe<br />atmosphere.<br /><br /><hr><table><tr><td>Example 1 - Zeroing out the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s1600/zero_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s320/zero_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s1600/zero_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s320/zero_pca_timestreams.png" /></a></div></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Example 2 - Fitting and removing the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s1600/fitline_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s1600/fitline_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s320/fitline_pca_timestreams.png" /></a></div></td></tr>  <tr><td colspan=2><br></td></tr><tr><td>Example 3 - Suppressing the lines with a non-fitted Gaussian:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s1600/wingsupp_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr><tr><td colspan=2><br></td></tr><tr><td colspan=2><hr></td></tr> <tr><td colspan=2><br />The next examples are from December 2010 observations of Uranus.  In this case, the correlated noise component is clearly dominant.<br /></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Zeroing lines:</td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s1600/zero_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s320/zero_pca_psds.png" /></a><br /></td><td><br /><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s1600/zero_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s320/zero_pca_timestreams.png" /></a></div></td></tr></td></tr> <tr><td><br />Fitted lines:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s1600/fitline_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s1600/fitline_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s320/fitline_pca_timestreams.png" /></a></div></td></tr> <tr><td><br />Non-fitted gaussian suppression:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s1600/wingsupp_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr>   <tr><td colspan=2><hr></td></tr><tr><td><br> Finally, these two are demonstrations of what you might expect to see for a purely noiseless images of a planet (it was constructed from a PSF).  PCA is first:<br /></td></tr> <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s1600/noiselesssim_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s320/noiselesssim_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s1600/noiselesssim_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s320/noiselesssim_pca_timestreams.png" /></a></div></td></tr> <tr><td><br /><br> A single bolometer's timestream and PSD:<br /></td></tr>  <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" /></a></div></td></tr>  </table></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Some pretty neat things about delining....]]></title>
    <link href="http://keflavich.github.com/blog/2011/02/02/some-pretty-neat-things-about-delining/"/>
    <updated>2011-02-02T21:50:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/02/02/some-pretty-neat-things-about-delining</id>
    <content type="html"><![CDATA[<div class='post'>
Well, I did the work, so might as well come up with some plots...<br /><br />I created a gaussian-fitting based delining code that saves all of the fits in a text file!  That's a lot of data to play with, and allows me to draw some conclusions:<br /><br /><ol><li> For the narrow lines, the linewidth (gaussian sigma) is 0.03 Hz.  For the wide lines, it is 0.05. <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUorHEcJO0I/AAAAAAAAF7k/TaWEWrbczZ0/s1600/histogram_fit_deline_linewidths.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUorHEcJO0I/AAAAAAAAF7k/TaWEWrbczZ0/s320/histogram_fit_deline_linewidths.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUorHusiIdI/AAAAAAAAF7s/NX67lE3OgaQ/s1600/histogram_fit_deline_linewidths_wide.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUorHusiIdI/AAAAAAAAF7s/NX67lE3OgaQ/s320/histogram_fit_deline_linewidths_wide.png" /></a></div><br /><li> The amplitudes from December 2010 are ENORMOUS compared to others!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUosLpxdcdI/AAAAAAAAF70/QTgqsu4uQrg/s1600/histogram_fit_deline_amplitudes_epochcompare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUosLpxdcdI/AAAAAAAAF70/QTgqsu4uQrg/s320/histogram_fit_deline_amplitudes_epochcompare.png" /></a></div><br /><li> The width distributions of the two are similar, though the lines appear to be significantly wider in July 2009<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUotc81_ztI/AAAAAAAAF78/8nxzuv8Apc8/s1600/histogram_fit_deline_width_epochcompare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUotc81_ztI/AAAAAAAAF78/8nxzuv8Apc8/s320/histogram_fit_deline_width_epochcompare.png" /></a></div><br /></ol> I've also gotten to the point that I'm satisfied with how delining with wing suppression works.  Wing suppression is 0.4-2x quicker than fitting directly, depending on... not clear what exactly; it depends on epoch, but that could either be because there are more lines found or because of relative data size.  Does delining have to be done on whole timestreams, or can it be done on a scan-by-scan basis?  This is not entirely clear... the peaks are less suppressed when done on a scan-by-scan basis (presumably because the S/N is low and peaks are therefore not detected), but incorrect suppression (removing a line that's not there) is reduced.  For short scans, the scan-by-scan approach is 10x faster; for longer scans it's ~20% faster.  I think the scan-by-scan approach is going to be ideal. <br><hr><br>Examples from l089 (0709):  <br>Top row: non-fitted line suppression <div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUowz4zgpsI/AAAAAAAAF8E/iJd0tAbVj0U/s1600/deline_10hz_wingsuppress_psds_003.png" imageanchor="1" style="margin-left:1em; margin-left:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUowz4zgpsI/AAAAAAAAF8E/iJd0tAbVj0U/s320/deline_10hz_wingsuppress_psds_003.png" /></a><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUow1IQ_Y9I/AAAAAAAAF8c/1OkISODwwPM/s1600/deline_fitline_10hz_noscan_nsig0_preservephase_timestreams_003.png" imageanchor="1" style="margin-right:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUow1IQ_Y9I/AAAAAAAAF8c/1OkISODwwPM/s320/deline_fitline_10hz_noscan_nsig0_preservephase_timestreams_003.png" /></a></div><br> <br>Bottom row: fitted line suppression <div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUow0sTBKsI/AAAAAAAAF8U/GtL0nyvlNBw/s1600/deline_fitline_10hz_noscan_nsig0_preservephase_psds_003.png" imageanchor="1" style="margin-left:1em; margin-left:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUow0sTBKsI/AAAAAAAAF8U/GtL0nyvlNBw/s320/deline_fitline_10hz_noscan_nsig0_preservephase_psds_003.png" /></a><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUow0d-vEcI/AAAAAAAAF8M/or2gkvGxW4o/s1600/deline_10hz_wingsuppress_timestreams_003.png" imageanchor="1" style="margin-right:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUow0d-vEcI/AAAAAAAAF8M/or2gkvGxW4o/s320/deline_10hz_wingsuppress_timestreams_003.png" /></a></div><br><br><hr><div class="separator" style="clear: both; text-align: left;"><br><left>Examples from Uranus (1012, really really liney):</left></div><br>Top row: non-fitted line suppression <div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUoxEvWqRwI/AAAAAAAAF8k/J6ImhPN9ZS0/s1600/deline_10hz_wingsuppress_psds_003.png" imageanchor="1" style="margin-left:1em; margin-left:1em"><img align='left' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUoxEvWqRwI/AAAAAAAAF8k/J6ImhPN9ZS0/s320/deline_10hz_wingsuppress_psds_003.png" /></a><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUoxFMLdujI/AAAAAAAAF8s/DrzWxFCdBu0/s1600/deline_10hz_wingsuppress_timestreams_003.png" imageanchor="1" style="margin-right:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUoxFMLdujI/AAAAAAAAF8s/DrzWxFCdBu0/s320/deline_10hz_wingsuppress_timestreams_003.png" /></a></div><br> <br>Bottom row: fitted line suppression <div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUoxFXYN_tI/AAAAAAAAF80/BQwv6ROSOJ4/s1600/deline_fitline_10hz_noscan_nsig0_preservephase_psds_003.png" imageanchor="1" style="margin-left:1em; margin-left:1em"><img align='left' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUoxFXYN_tI/AAAAAAAAF80/BQwv6ROSOJ4/s320/deline_fitline_10hz_noscan_nsig0_preservephase_psds_003.png" /></a><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUoxF_c0URI/AAAAAAAAF88/JU9_F-8HC2k/s1600/deline_fitline_10hz_noscan_nsig0_preservephase_timestreams_003.png" imageanchor="1" style="margin-right:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUoxF_c0URI/AAAAAAAAF88/JU9_F-8HC2k/s320/deline_fitline_10hz_noscan_nsig0_preservephase_timestreams_003.png" /></a></div></div>


<h2>Comments</h2>


<div class='comments'>
<div class='comment'>
<div class='author'>Adam</div>
<div class='content'>
Next step: prove that this works in maps...</div>
</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Delining]]></title>
    <link href="http://keflavich.github.com/blog/2011/02/01/delining/"/>
    <updated>2011-02-01T18:35:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/02/01/delining</id>
    <content type="html"><![CDATA[<div class='post'>
Delining refers to the process of removing electronic noise that is aliased to<br />particular frequencies by the discrete sampling of the data.  Typical<br />electronic noise is at 60 Hz with some width.  It gets aliased to these<br />frequencies:<br /><br /><br /><code>linefreqs = [10.05+findgen(10)*1.2,10.05-((findgen(7)+1))*1.2]</code><br /><br />The 10.05 Hz and 20.10 Hz are the worst in most cases, and they are wider.  For<br />the above lines, we "remove" a bandwidth of 0.09 Hz by averaging over the<br />neighboring 0.5 Hz on either side.  For the wider lines, we remove 0.5 Hz by<br />averaging over the neighboring 1.5 Hz on either side.<br /><br /><br /><br />There are a few new things about the delining process that did not exist in James' old version:<br /><ol><li> The wide-band lines are removed<br /><li> A check is performed before removing the lines - they are only removed if the line region mean is<br />2-sigma above the average region (as computed via median and mad)<br /><li> The replaced noise is computed via median/mad, and the new noise level is set 5x lower than in the<br />neighboring region<br /></ol><hr>Now, some examples:   <div class="separator" style="clear: both; text-align: left;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUisqDHJ08I/AAAAAAAAF58/BpgnudfdAAw/s1600/deline_timestreams_003.png" imageanchor="1" style=""><img align='left' border="0" height="267" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUisqDHJ08I/AAAAAAAAF58/BpgnudfdAAw/s400/deline_timestreams_003.png" /></a>  <a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUisqWN6ueI/AAAAAAAAF6E/yAka7dlomjo/s1600/deline_psds_003.png" imageanchor="1" style=""><img align='right' border="0" height="267" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUisqWN6ueI/AAAAAAAAF6E/yAka7dlomjo/s400/deline_psds_003.png" /></a></div> The timestream (left) and PSD (right) of a "pretty good" bolometer.  There is a lot of noise in lines, but note that the peak power is 2-3 orders of magnitude below the PSD peak.  In this case the "Power" is in Jy.  There is little astrophysical information below ~14" (9 Hz), and there should be none below 7.2" (17 Hz), but there is plausibly information at these scales.  It therefore makes sense to save as much information as possible.  As can be seen in the delined PSD, the peaks drop by a substantial fraction, but not all the way - that's because these lines are wider than typically observed.  Unfortunately, I don't have any really good ideas about how to fix this issue - I think fitting gaussians to each line, while attractive, is going to be prohibitively expensive in both programmer and processor time.  However... it would be a very interesting project to undertake.    In the timestream, it can be seen that the RMS drops substantially when the lines are filtered out (note that the timestream is strongly dominated by large-scale structure, so 'substantial' is really based on the RMS of the lines removed).   <div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUisq6D55wI/AAAAAAAAF6M/PZ4hyu5FkZM/s1600/deline_10hz_timestreams_003.png" imageanchor="1" style=""><img align=left border="0" height="267" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUisq6D55wI/AAAAAAAAF6M/PZ4hyu5FkZM/s400/deline_10hz_timestreams_003.png" /></a>  <a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUisrWpL7yI/AAAAAAAAF6U/tSsL5Jc4n-A/s1600/deline_10hz_psds_003.png" imageanchor="1" style=""><img align=right border="0" height="267" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUisrWpL7yI/AAAAAAAAF6U/tSsL5Jc4n-A/s400/deline_10hz_psds_003.png" /></a></div>The next two plots look identical to the previous ones.  In principle, they include the wide-band delining.  However, in this case, the satellite lines to either side of the 10 Hz line are too strong and prevent identification of the 10 Hz line.  This is unfortunate, again, but no obvious solution presents itself.   <div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixLZbVHPI/AAAAAAAAF6c/xCWLpb9CKX4/s1600/deline_timestreams_004.png" imageanchor="1" style=""><img align=left border="0" height="267" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixLZbVHPI/AAAAAAAAF6c/xCWLpb9CKX4/s400/deline_timestreams_004.png" /></a>  <a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixL8APCQI/AAAAAAAAF6k/j8FyKbgOdDo/s1600/deline_psds_004.png" imageanchor="1" style=""><img  align=right border="0" height="267" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixL8APCQI/AAAAAAAAF6k/j8FyKbgOdDo/s400/deline_psds_004.png" /></a></div>Now we come to a truly problematic bolometer.  The lines completely dominate the power spectrum.  Narrow line removal fails.  <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUixMjNxbkI/AAAAAAAAF6s/Hr8ouprcMpY/s1600/deline_10hz_timestreams_004.png" imageanchor="1" style=""><img align=left border="0" height="267" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUixMjNxbkI/AAAAAAAAF6s/Hr8ouprcMpY/s400/deline_10hz_timestreams_004.png" /></a>  <a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixNMO2NsI/AAAAAAAAF60/ZAsirbb25QY/s1600/deline_10hz_psds_004.png" imageanchor="1" style=""><img align=right border="0" height="267" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUixNMO2NsI/AAAAAAAAF60/ZAsirbb25QY/s400/deline_10hz_psds_004.png" /></a></div>Wide line removal does a much, much better job, dropping the RMS by an order of magnitude.... but the bolometer probably still needs to be removed, since the astrophysical signal is 2-3 orders of magnitude below that.   <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUizkq9x4TI/AAAAAAAAF68/2xYY86d6aTQ/s1600/deline_timestreams_001.png" imageanchor="1" style=""><img align=left border="0" height="267" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUizkq9x4TI/AAAAAAAAF68/2xYY86d6aTQ/s400/deline_timestreams_001.png" /></a>  <a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUizlH0XvMI/AAAAAAAAF7E/ptDb5I3os6A/s1600/deline_psds_001.png" imageanchor="1" style=""><img align=right border="0" height="267" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUizlH0XvMI/AAAAAAAAF7E/ptDb5I3os6A/s400/deline_psds_001.png" /></a></div>The 2010 data had much worse line noise and had to be delined.  JS accomplished this by throwing out all data above a certain frequency, but I prefer the delining approach.  It is clearly effective, but again leaves much to be desired.  Should the flagged bandwidth be increased?  What about the extra lines around 18 Hz?  <div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUizln1mSCI/AAAAAAAAF7M/hTkZRUU3-ck/s1600/deline_10hz_timestreams_001.png" imageanchor="1" style=""><img align=left border="0" height="267" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUizln1mSCI/AAAAAAAAF7M/hTkZRUU3-ck/s400/deline_10hz_timestreams_001.png" /></a>  <a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUizmdrMkgI/AAAAAAAAF7U/-dlB4u30hBo/s1600/deline_10hz_psds_001.png" imageanchor="1" style=""><img align=right border="0" height="267" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUizmdrMkgI/AAAAAAAAF7U/-dlB4u30hBo/s400/deline_10hz_psds_001.png" /></a></div><br />Again, the wide line flagging fails because of the satellite lines.</div>


<h2>Comments</h2>


<div class='comments'>
<div class='comment'>
<div class='author'>Adam</div>
<div class='content'>
Bleh, a whole day&#39;s work dedicate to new delining methods and testing.  Very unrewarding.  However, there are results that I need to FINALLY prove and show tomorrow:<br />1. amplitude suppression + phase preservation is a good alternative to zeroing/scrambling or replacing with noise<br />2. line fitting is effective but slow<br />3. Assuming a line profile and suppressing is nearly as effective as line fitting<br />4. scan-by-scan is less effective than observation-by-observation for fitting (but it&#39;s not clear if that holds for other methods)</div>
</div>
<div class='comment'>
<div class='author'>Adam</div>
<div class='content'>
What about the effects on the map?  Unfortunately, in the tests I&#39;ve run, delining actually INCREASES the noise in the map!  How is this possible?  My only hypothesis is that PCA cleaning does an excellent job of removing the line noise, but when it is replaced with truly uncorrelated gaussian noise, the PCA cleaning no longer removes that component.  <br /><br />But we don&#39;t want PCA cleaning to grab instrumental correlated noise; we want it to be limited to atmospheric noise.  So ideally we want to completely remove the line noise without adding noise to the image... maybe the line regions should just be set to zero after all....</div>
</div>
</div>

]]></content>
  </entry>
  
</feed>
