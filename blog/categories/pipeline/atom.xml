<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: pipeline | Adam Ginsburg's Astro Blog]]></title>
  <link href="http://keflavich.github.com/blog/categories/pipeline/atom.xml" rel="self"/>
  <link href="http://keflavich.github.com/"/>
  <updated>2012-12-28T17:29:05-07:00</updated>
  <id>http://keflavich.github.com/</id>
  <author>
    <name><![CDATA[Adam Ginsburg]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Flow Charts]]></title>
    <link href="http://keflavich.github.com/blog/2011/12/30/flow-charts/"/>
    <updated>2011-12-30T19:53:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/12/30/flow-charts</id>
    <content type="html"><![CDATA[<div class='post'>
Made with <a href="http://code.google.com/p/bgpspipeline/source/browse/bgps_pipeline/documentation/wrap_pipeline_and_log.py"> this code </a> and <a href="www.graphviz.org">graphviz</a>.<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-rbeS36D6fek/Tv55L9HSfVI/AAAAAAAAGrE/VArJAV60nys/s1600/pipeline_v1.0.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="78" width="320" src="http://2.bp.blogspot.com/-rbeS36D6fek/Tv55L9HSfVI/AAAAAAAAGrE/VArJAV60nys/s320/pipeline_v1.0.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lI_OWOGIVko/Tv55MIfhcdI/AAAAAAAAGrU/MUiQuiBLqrA/s1600/pipeline_v2.0.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="76" width="320" src="http://2.bp.blogspot.com/-lI_OWOGIVko/Tv55MIfhcdI/AAAAAAAAGrU/MUiQuiBLqrA/s320/pipeline_v2.0.png" /></a></div></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spatial Transfer Functions, revisit 4]]></title>
    <link href="http://keflavich.github.com/blog/2011/08/05/spatial-transfer-functions-revisit-4/"/>
    <updated>2011-08-05T12:56:00-06:00</updated>
    <id>http://keflavich.github.com/blog/2011/08/05/spatial-transfer-functions-revisit-4</id>
    <content type="html"><![CDATA[<div class='post'>
Last report was a bit of a fiasco.  There were problems all over the place I didn't understand.  I still don't but I've fixed them.  My best guess at this point is that a pass-by-reference led to an unacceptable modification of an image.  That doesn't even make sense - there was no place it could have happened - but, there you have it.<br /><br />So, going through the process step by step.<br /><br />This is the effect of smoothing an image:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-3TabjiWVKm4/Tjs03gqxkxI/AAAAAAAAGXk/BQOH5FvG3CM/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/-3TabjiWVKm4/Tjs03gqxkxI/AAAAAAAAGXk/BQOH5FvG3CM/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_psds.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-AWglr2CHB-0/Tjs04fniKDI/AAAAAAAAGXs/MM3RCNu6x10/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/-AWglr2CHB-0/Tjs04fniKDI/AAAAAAAAGXs/MM3RCNu6x10/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_compare.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-5yFhvF1iOeY/Tjs1ES7HeuI/AAAAAAAAGX0/T44kJArWn2o/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_stf.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://2.bp.blogspot.com/-5yFhvF1iOeY/Tjs1ES7HeuI/AAAAAAAAGX0/T44kJArWn2o/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky02_seed00_peak010.00_SMvsNOSM_input_stf.png" /></a></div><br />Note from the 3rd figure that 100% recovery isn't reached until ~700 arcseconds.<br /><br /><br />Next question: What is happening at large spatial scales in the flat-spectrum simulations?<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Fi2EBFsPFK4/TjtLzkxRxRI/AAAAAAAAGX8/4GoYEwSaaKc/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky07_seed00_peak100.00_smooth_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/-Fi2EBFsPFK4/TjtLzkxRxRI/AAAAAAAAGX8/4GoYEwSaaKc/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky07_seed00_peak100.00_smooth_compare.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-P3TEAHevkEY/TjtL0BG8BbI/AAAAAAAAGYE/oC71ZTFTz3k/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky06_seed00_peak100.00_smooth_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://2.bp.blogspot.com/-P3TEAHevkEY/TjtL0BG8BbI/AAAAAAAAGYE/oC71ZTFTz3k/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky06_seed00_peak100.00_smooth_compare.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-g0m5hEHx8QY/TjtL00D3USI/AAAAAAAAGYM/687cgIORovk/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky05_seed00_peak100.00_smooth_compare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://4.bp.blogspot.com/-g0m5hEHx8QY/TjtL00D3USI/AAAAAAAAGYM/687cgIORovk/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky05_seed00_peak100.00_smooth_compare.png" /></a></div><br />No obvious problems there.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-DwXSkiyw2kE/TjtNt7XadiI/AAAAAAAAGYU/trzLma37DgM/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky05_seed00_peak100.00_smooth_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://3.bp.blogspot.com/-DwXSkiyw2kE/TjtNt7XadiI/AAAAAAAAGYU/trzLma37DgM/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky05_seed00_peak100.00_smooth_psds.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Q9ItTP7uQDs/TjtNuILPfLI/AAAAAAAAGYc/w67japCoUpo/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky06_seed00_peak100.00_smooth_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://1.bp.blogspot.com/-Q9ItTP7uQDs/TjtNuILPfLI/AAAAAAAAGYc/w67japCoUpo/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky06_seed00_peak100.00_smooth_psds.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-mgWHY8CT3tQ/TjtNuv1jZ-I/AAAAAAAAGYk/Iddg_I2UKjo/s1600/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky07_seed00_peak100.00_smooth_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://3.bp.blogspot.com/-mgWHY8CT3tQ/TjtNuv1jZ-I/AAAAAAAAGYk/Iddg_I2UKjo/s320/exp10_ds2_astrosky_arrang45_atmotest_amp1.0E%252B01_sky07_seed00_peak100.00_smooth_psds.png" /></a></div><br />Hmm, no apparent problem here either, though one might ask why the two curves approach each other in sky05 (alpha=-0.5).<br /><br />So it appears that the reason for the bump up at low frequencies (long wavelengths) must be because of edge effects.  After much hassle, I've addressed that by cropping images.<br /><br />Finally, the averaged results:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-26KmVHKU_QY/Tjw8VVYnkkI/AAAAAAAAGY4/-R-e3mwVwZc/s1600/stfs_bestmodel_fits.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="214" width="320" src="http://3.bp.blogspot.com/-26KmVHKU_QY/Tjw8VVYnkkI/AAAAAAAAGY4/-R-e3mwVwZc/s320/stfs_bestmodel_fits.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lPtvV465aLg/Tjw8VhQZXXI/AAAAAAAAGZA/Rib4AX6z75E/s1600/stfs_bestmodels.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="214" width="320" src="http://2.bp.blogspot.com/-lPtvV465aLg/Tjw8VhQZXXI/AAAAAAAAGZA/Rib4AX6z75E/s320/stfs_bestmodels.png" /></a></div><br /><br /><br />So we've got an Official Spatial Transfer Function.<br /><br />However, of course, we must note that there is a dependence on the atmosphere amplitude to source amplitude ratio: it appears that large-scale structure is *easier* to recover when the atmosphere is at higher amplitude.  This makes sense: it is easier to distinguish faint astrophysical signal from bright atmosphere in this case.  The reason I didn't run simulations to test this more is that the S/N ratio on small scales becomes poor for the low astrophysical amplitudes.</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[minor] Ongoing problems...]]></title>
    <link href="http://keflavich.github.com/blog/2011/07/10/minor-ongoing-problems/"/>
    <updated>2011-07-10T13:41:00-06:00</updated>
    <id>http://keflavich.github.com/blog/2011/07/10/minor-ongoing-problems</id>
    <content type="html"><![CDATA[<div class='post'>
Since I have many tasks running in parallel, I need to summarize them sometimes...<br /><br /><ol><li> There are many "bad" observations that haven't been placed in "bad" directories. A list of the error messages generated is here: <a href="http://code.google.com/p/bgpspipeline/wiki/MakingInfiles">Making Infiles wiki</a><br /><li> There may be streaking in the BGPS ds2 images of l030 and l032.  Still trying to re-run cleanly to find out<br /><li> There may be unflagged high-points in l030 and l032.  Also under examination<br /><li> Simulations have been generating bulk-offset outputs; my suspicion was that the relative scales were being set incorrectly because astro dominated atmo, so I bumped up the atmo scale.   The tests have run but I haven't examined the outputs<br /><li> V1 sims have shown streaking, possibly because of the previous bullet, but certainly (in part) because cross-scans haven't worked<br /></ol></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Astrophysical Signal Modeling]]></title>
    <link href="http://keflavich.github.com/blog/2011/05/24/astrophysical-signal-modeling/"/>
    <updated>2011-05-24T11:39:00-06:00</updated>
    <id>http://keflavich.github.com/blog/2011/05/24/astrophysical-signal-modeling</id>
    <content type="html"><![CDATA[<div class='post'>
Here we finally get into the meat of the simulations.  The goal is to develop realistic - but arbitrary - astrophysical models to run through simulations.<br /><br />The first step is to figure out what a realistic sky looks like.  To this end, I use the HiGal SDP fields, looking only at their power spectra.  They are well represented by a power law with &alpha; = 3 (shown in the dashed black line below).<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-50R2lfaIGrY/TdvZi5tl5VI/AAAAAAAAGLQ/w45OC9dk3Rg/s1600/sdp_psds_powerlaw.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="249" width="320" src="http://2.bp.blogspot.com/-50R2lfaIGrY/TdvZi5tl5VI/AAAAAAAAGLQ/w45OC9dk3Rg/s320/sdp_psds_powerlaw.png" /></a></div><br />Therefore, I've attempted to randomly sample from a similar power law distribution using the following IDL code:<br /><code><br />    dimsize = 512<br /><br />    realpower = realpowers[ii]<br />    imagpower = imagpowers[ii]<br />    imagscale = imagscales[ii]<br />    peakamp = 1.0<br />    noise = 0.03<br />    smoothscale = 2.0<br />    smoothkernel = psf_gaussian(npix=512,ndim=2,fwhm=31.2/7.2/2.0,/normalize)<br />    sigma_gp = 128.0 ; sigma-width of the Galactic Plane (can get more accurate value from Cara's paper)<br /><br />    xx = findgen(dimsize) #  replicate(1.0,dimsize)<br />    yy = findgen(dimsize) ## replicate(1.0,dimsize)<br />    rr = sqrt( (xx-255.5)^2 + (yy-255.5)^2 )<br />    realpart = (rr^realpower) * randomn(seed1,[dimsize,dimsize])<br />    imagpart = ((rr*imagscale)^imagpower) * randomn(seed2,[dimsize,dimsize])*complex(0,1) <br />    fakesky = abs(fft(shift(realpart + imagpart,0,0),1))<br />    expweight = exp(-(yy-255.5)^2/(2.0*sigma_gp^2)) ; most power is in the inner plane<br /><br />    fakesky *= peakamp/max(fakesky)<br />    fakesky_sm = convolve(fakesky,smoothkernel)<br />    fakesky_sm = fakesky_sm*expweight<br />    fakesky_sm += randomn(seed3,[dimsize,dimsize]) * noise<br /></code><br /><br />Since Power is the fourier-transform squared, I'm using a power-law of &alpha;=1.5 for the "real" part of the sampling.  The imaginary part follows a shallower slope to reduce the amount of power in large structures, which didn't look quite right (but maybe I should leave both slopes the same?).  With both the same, and without the imaginary part down-scaled, the structure appears too "cloudy" and not "clumpy" enough.  But back to that later...<br /><br />The peak amplitude is set by re-scaling the map.  Ideally, we'd like to see this set by a point source, since that is true in most fields.<br /><br />The noise level should not be included in simulations, but should be used to show the difference between pipeline-leftover noise and gaussian noise on the sky.  i.e., what structures disappear when you just add noise, and what structures are removed by the pipeline.<br /><br />The PSF is simply to smooth out signals that are removed by the telescope beam.  We can replace this with a "real" PSF if and when we've come up with a believable one.<br /><br />The noise is added after the smoothing because it should be on a pixel scale rather than a beam scale.<br /><br />Here are some example realizations with different power laws:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-vCy9Lx2RjWw/Tdvs_PO1u6I/AAAAAAAAGLw/cc7cIupQu0U/s1600/exp7_fakesky_sm_realP-1.0_imagP-1.0_imagS01.0_seednum02.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://3.bp.blogspot.com/-vCy9Lx2RjWw/Tdvs_PO1u6I/AAAAAAAAGLw/cc7cIupQu0U/s320/exp7_fakesky_sm_realP-1.0_imagP-1.0_imagS01.0_seednum02.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-qpgg2U41r6U/Tdvs_RPxARI/AAAAAAAAGL4/v5exzhhqDew/s1600/exp7_fakesky_sm_realP-1.5_imagP-1.5_imagS01.0_seednum02.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://4.bp.blogspot.com/-qpgg2U41r6U/Tdvs_RPxARI/AAAAAAAAGL4/v5exzhhqDew/s320/exp7_fakesky_sm_realP-1.5_imagP-1.5_imagS01.0_seednum02.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-2kUqO9aE8zM/Tdvs_maHaCI/AAAAAAAAGMA/u5bDCfiVuH0/s1600/exp7_fakesky_sm_realP-2.0_imagP-2.0_imagS01.0_seednum02.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="320" width="320" src="http://3.bp.blogspot.com/-2kUqO9aE8zM/Tdvs_maHaCI/AAAAAAAAGMA/u5bDCfiVuH0/s320/exp7_fakesky_sm_realP-2.0_imagP-2.0_imagS01.0_seednum02.png" /></a></div></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PSF modeling]]></title>
    <link href="http://keflavich.github.com/blog/2011/05/21/psf-modeling/"/>
    <updated>2011-05-21T19:19:00-06:00</updated>
    <id>http://keflavich.github.com/blog/2011/05/21/psf-modeling</id>
    <content type="html"><![CDATA[<div class='post'>
There haven't been many posts recently because I've primarily been writing up old results into the v2 paper.<br /><br />The Airy and Gaussian simulations with and without atmosphere seem to have yielded their results.  There is a ~5% loss when mapping Airy-disk point sources.  This is fine as long as it's quantified; it just means that when calibrating we need to know whether extended sources are similarly truncated.  If all sources lose 5% in the pipeline, there will be no net offset.<br /><br />However, the Airy is not necessarily representative of the CSO's PSF.  <br /><br />In order to come up with a more reasonable representation of the PSF, I've attempted to fit the *measured* PSF (from James' paper) with an Airy disk.  The first sidelobe has a lot more amplitude and is closer to the peak than in an Airy disk.  It is also asymmetric, but I'm ignoring that for the moment.<br /><br />To better represent the first sidelobe, I've fitted a modified Airy function.  The "modification" is to fit two Airy functions, one to the peak and one to the rest.  This is accomplished by setting everything outside the first null to zero in the first function, and everything inside the first null to zero in the second.  The centers are the same, but the amplitudes and widths are independent.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Vd8eey7FX4Q/TdhiEsk-FhI/AAAAAAAAGLA/ekzBJL8oNoE/s1600/airy_modified_comparison.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="215" width="320" src="http://3.bp.blogspot.com/-Vd8eey7FX4Q/TdhiEsk-FhI/AAAAAAAAGLA/ekzBJL8oNoE/s320/airy_modified_comparison.png" /></a></div><br />The above image shows the best fit Airy and modified Airy, both in log scale on an identical grid.  The modeled PSF was then put through the pipeline to see it recovers the pipeline-derived PSF.  The radial profile results are below, but note that this is only one particular realization of the simulation + pipeline.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-sxL-QjhRxUE/TdhidbXuAKI/AAAAAAAAGLI/NX9LdWqu4nM/s1600/PSF_fit_plot_pipelinecompare.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="215" width="320" src="http://2.bp.blogspot.com/-sxL-QjhRxUE/TdhidbXuAKI/AAAAAAAAGLI/NX9LdWqu4nM/s320/PSF_fit_plot_pipelinecompare.png" /></a></div><br /><br />Note that the model matches the first sidelobe in the "observed" PSF pretty well, but both before and after pipeline processing, overpredicts the second sidelobe.  <br /><br /><br />There are a few "action items" remaining for this task:<br /><ol><li> Re-derive the "observed" PSF using V2.  Does it vary with epoch?  Source?  <br /><li> Find a model that better recovers the observed PSF<br /></ol><br />Any thoughts on better models to use?  Does this seem like a good idea at all?</div>

]]></content>
  </entry>
  
</feed>
