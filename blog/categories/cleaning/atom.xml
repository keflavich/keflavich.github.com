<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: cleaning | Adam Ginsburg's Astro Blog]]></title>
  <link href="http://keflavich.github.com/blog/categories/cleaning/atom.xml" rel="self"/>
  <link href="http://keflavich.github.com/"/>
  <updated>2012-12-28T17:22:06-07:00</updated>
  <id>http://keflavich.github.com/</id>
  <author>
    <name><![CDATA[Adam Ginsburg]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Deconvolution vs. Not]]></title>
    <link href="http://keflavich.github.com/blog/2011/04/07/deconvolution-vs-not/"/>
    <updated>2011-04-07T12:36:00-06:00</updated>
    <id>http://keflavich.github.com/blog/2011/04/07/deconvolution-vs-not</id>
    <content type="html"><![CDATA[<div class='post'>
In the W5 maps, everywhere except AFGL 4029 agrees to within about 20% (better than our supposed offset) independent of deconvolution scheme / modeling scheme, but AFGL 4029 disagrees by a factor of 2-3, indicating a severe dependence on map size.<br /><br />Here's the AFGL 4029 comparison originally: <br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.1515<br />Sum: 194.028  Mean: 1.03758  Median: 0.78441  RMS: 0.760825  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 5.77585<br />Sum: 137.481  Mean: 0.735194  Median: 0.517222  RMS: 0.663245  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 14.4043<br />Sum: 342.863  Mean: 1.83349  Median: 1.62579  RMS: 0.820079  NPIX: 187<br /><br />Here it is after flagging out another bad bolo:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.14533<br />Sum: 193.882  Mean: 1.0368  Median: 0.783409  RMS: 0.764047  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 10.1518<br />Sum: 241.642  Mean: 1.2922  Median: 1.06321  RMS: 0.777165  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 13.9344<br />Sum: 331.677  Mean: 1.77367  Median: 1.56277  RMS: 0.820139  NPIX: 187<br /><br />order is deconvtest, nodeconvtest, 'reconv'<br /><br />deconvtest has virtually no change.  nodeconvtest goes up by a LOT... must be something about the weighting.  reconv drops, which is good, but not enough...<br /><br />curiously, it is not clear that nodeconv converges:  [10, 15, 20 iters]<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.70939<br />Sum: 207.308  Mean: 1.34615  Median: 1.09348  RMS: 0.760452  NPIX: 154<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 9.14028<br />Sum: 217.564  Mean: 1.41275  Median: 1.17223  RMS: 0.759027  NPIX: 154<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 9.42483<br />Sum: 224.337  Mean: 1.45673  Median: 1.2172  RMS: 0.758978  NPIX: 154<br /><br />similarly, reconv does not converge:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 11.5623<br />Sum: 275.214  Mean: 1.61891  Median: 1.36357  RMS: 0.809771  NPIX: 170<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 12.5848<br />Sum: 299.553  Mean: 1.76208  Median: 1.51426  RMS: 0.807963  NPIX: 170<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 13.3102<br />Sum: 316.82  Mean: 1.86365  Median: 1.62092  RMS: 0.804582  NPIX: 170<br /><br /><br />by contrast, deconv converges rapidly:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.27004<br />Sum: 196.85  Mean: 0.937381  Median: 0.659373  RMS: 0.759002  NPIX: 210<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.39255<br />Sum: 199.766  Mean: 0.951267  Median: 0.683644  RMS: 0.758766  NPIX: 210<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.42881<br />Sum: 200.629  Mean: 0.955377  Median: 0.690816  RMS: 0.75878  NPIX: 210<br /><br />while I'm at it, gaussfits for nodeconv and reconv:<br />Guess: 427,1113  Fit peak: 2.90411  Background: 0.0102637  X,Y position: 426.514822,1113.354863  X,Y FWHM: 64.253564,72.615868   Angle: 0.000000<br />Guess: 427,1113  Fit peak: 3.03769  Background: 0.000596982  X,Y position: 426.080980,1113.634660  X,Y FWHM: 77.405551,104.292823   Angle: 329.589335<br />well, isn't that neat!  Better than 5% agreement on the peaks.  Curiously, the background is higher for nodeconv, which is false: it is directly evident that the background is higher in reconv.  So I think this is just a failed fit, unfortunately.  The true peak of the reconv AFGL 4029 is 3.9 Jy, so there's a huge residual<br /><br /><br />Found an error in the noisemap computations that was artificially driving up the noise around NAN pixels in undersampled maps; this probably led to major problems.  I fixed it by only "flagging out" pixels with >2 NAN neighbors, i.e. so sparsely sampled that they should be ignored, I hope....  this may have affected modeling in all maps.<br /><br />Realized the problems with noisemap: if the model exactly equals the weighted mean at a given pixel, the residual will be EXACTLY zero (to within numerical precision).  This leads to underestimates of the noise!  What we really want is an estimate of the standard deviation on the mean, which is easily computed!  Just do a normal weighted sum of the difference between the data and the model (data and the mean); this is also equivalent (conveniently) to a chi^2 statistic, I think... Whoa.  How did I not do this before?  LETS FIND OUT I'M SURE THERE ARE AWFUL CONSEQUENCES!<br /><br /><br />Just had another idea to throw in - what if we downweight the scan edges?  It won't matter for individual maps or maps of the same size if done uniformly, but it could help incorporate "pointing" maps into "real" maps more accurately.</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Delining and the Cleaning process]]></title>
    <link href="http://keflavich.github.com/blog/2011/02/03/delining-and-cleaning-process/"/>
    <updated>2011-02-03T12:49:00-07:00</updated>
    <id>http://keflavich.github.com/blog/2011/02/03/delining-and-cleaning-process</id>
    <content type="html"><![CDATA[<div class='post'>
One item I forgot to mention last night was the effects of lines/delining on<br />PCA subtraction.  These should be the primary effects on the final map for all<br />epochs except 2010, in which case the primary effect SHOULD be to reduce<br />substantial noise.<br /><br><br />In the examples below, there are PSDs of whole timestreams (left) and<br />example timestreams from single scans (right).  The first thing to note is that<br />the delined timestreams still have correlated components in the line region,<br />but they are suppressed - their amplitudes, and therefore their sort order in<br />the PCA removal scheme, are changed.  Since PCA cleaning is by its nature adaptive<br />(the number of components remains fixed, but the order changes), these effects<br />can be significant and dangerous.  If the line noise is more correlated, a PCA<br />component will be dedicated to removing it instead of atmospheric signal.<br /><br><br />Below are examples from l089 (epoch 0709) first.  These have less correlated<br />line noise and are more typical of BGPS observations. The first PCA component,<br />the average, does not change much with PCA cleaning.  However it is clear that<br />the second component changes substantially, from large-amplitude high-frequency<br />noise to small-amplitude variations that are very likely to describe<br />atmosphere.<br /><br /><hr><table><tr><td>Example 1 - Zeroing out the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s1600/zero_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s320/zero_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s1600/zero_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s320/zero_pca_timestreams.png" /></a></div></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Example 2 - Fitting and removing the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s1600/fitline_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s1600/fitline_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s320/fitline_pca_timestreams.png" /></a></div></td></tr>  <tr><td colspan=2><br></td></tr><tr><td>Example 3 - Suppressing the lines with a non-fitted Gaussian:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s1600/wingsupp_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr><tr><td colspan=2><br></td></tr><tr><td colspan=2><hr></td></tr> <tr><td colspan=2><br />The next examples are from December 2010 observations of Uranus.  In this case, the correlated noise component is clearly dominant.<br /></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Zeroing lines:</td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s1600/zero_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s320/zero_pca_psds.png" /></a><br /></td><td><br /><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s1600/zero_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s320/zero_pca_timestreams.png" /></a></div></td></tr></td></tr> <tr><td><br />Fitted lines:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s1600/fitline_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s1600/fitline_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s320/fitline_pca_timestreams.png" /></a></div></td></tr> <tr><td><br />Non-fitted gaussian suppression:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s1600/wingsupp_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr>   <tr><td colspan=2><hr></td></tr><tr><td><br> Finally, these two are demonstrations of what you might expect to see for a purely noiseless images of a planet (it was constructed from a PSF).  PCA is first:<br /></td></tr> <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s1600/noiselesssim_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s320/noiselesssim_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s1600/noiselesssim_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s320/noiselesssim_pca_timestreams.png" /></a></div></td></tr> <tr><td><br /><br> A single bolometer's timestream and PSD:<br /></td></tr>  <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" /></a></div></td></tr>  </table></div>

]]></content>
  </entry>
  
</feed>
